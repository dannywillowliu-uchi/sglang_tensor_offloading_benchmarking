==========================================
PROFILE: OLD OFFLOAD (PR #15511 'before')
==========================================
Timestamp: Fri Jan 30 23:14:44 CST 2026
Job ID: 1422883
Node: ac045

Fri Jan 30 23:14:44 2026       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.288.01             Driver Version: 535.288.01   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA H100 PCIe               On  | 00000000:10:00.0 Off |                    0 |
| N/A   22C    P0              48W / 350W |      0MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA H100 PCIe               On  | 00000000:11:00.0 Off |                    0 |
| N/A   22C    P0              47W / 350W |      0MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA H100 PCIe               On  | 00000000:12:00.0 Off |                    0 |
| N/A   19C    P0              46W / 350W |      0MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA H100 PCIe               On  | 00000000:13:00.0 Off |                    0 |
| N/A   22C    P0              46W / 350W |      0MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA H100 PCIe               On  | 00000000:14:00.0 Off |                    0 |
| N/A   21C    P0              47W / 350W |      0MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA H100 PCIe               On  | 00000000:15:00.0 Off |                    0 |
| N/A   20C    P0              46W / 350W |      0MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA H100 PCIe               On  | 00000000:16:00.0 Off |                    0 |
| N/A   23C    P0              47W / 350W |      0MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA H100 PCIe               On  | 00000000:17:00.0 Off |                    0 |
| N/A   21C    P0              48W / 350W |      0MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+

PyTorch: 2.9.1+cu128
CUDA: 12.8
GPUs: 8

Running nsys profile + sglang generate (old offload)...

[01-30 23:15:07] server_args: {"model_path": "./models/wan2.2", "backend": "auto", "attention_backend": "sage_attn", "diffusers_attention_backend": null, "nccl_port": null, "trust_remote_code": false, "revision": null, "num_gpus": 8, "tp_size": 1, "sp_degree": 8, "ulysses_degree": 8, "ring_degree": 1, "dp_size": 1, "dp_degree": 1, "enable_cfg_parallel": false, "hsdp_replicate_dim": 1, "hsdp_shard_dim": 8, "dist_timeout": null, "pipeline_class_name": null, "lora_path": null, "lora_nickname": "default", "vae_path": null, "lora_target_modules": null, "dit_cpu_offload": true, "dit_layerwise_offload": false, "text_encoder_cpu_offload": true, "image_encoder_cpu_offload": true, "vae_cpu_offload": true, "use_fsdp_inference": false, "pin_cpu_memory": true, "comfyui_mode": false, "mask_strategy_file_path": null, "STA_mode": "STA_inference", "skip_time_steps": 15, "enable_torch_compile": true, "warmup": false, "warmup_resolutions": null, "disable_autocast": false, "VSA_sparsity": 0.0, "moba_config_path": null, "moba_config": {}, "master_port": 30050, "host": "127.0.0.1", "port": 30000, "webui": false, "webui_port": 12312, "scheduler_port": 5615, "output_path": "./results/old_offload_1422883.mp4", "prompt_file_path": null, "model_paths": {}, "model_loaded": {"transformer": true, "vae": true}, "boundary_ratio": null, "log_level": "info"}
[01-30 23:15:07] Local mode: True
[01-30 23:15:07] Starting server...
[01-30 23:15:18] Scheduler bind at endpoint: tcp://127.0.0.1:5615
[01-30 23:15:19] Initializing distributed environment with world_size=8, device=cuda:0
[01-30 23:15:20] Found nccl from library libnccl.so.2
[01-30 23:15:20] sglang-diffusion is using nccl==2.27.5
[01-30 23:15:22] Found nccl from library libnccl.so.2
[01-30 23:15:22] sglang-diffusion is using nccl==2.27.5
[01-30 23:15:23] No pipeline_class_name specified, using model_index.json
[01-30 23:15:23] Diffusers version: 0.35.0.dev0
[01-30 23:15:23] Diffusers version: 0.35.0.dev0
[01-30 23:15:23] Using native sglang backend for model './models/wan2.2'
[01-30 23:15:23] Found model info: ModelInfo(pipeline_cls=<class 'sglang.multimodal_gen.runtime.pipelines.wan_pipeline.WanPipeline'>, sampling_param_cls=<class 'sglang.multimodal_gen.configs.sample.wan.WanT2V_1_3B_SamplingParams'>, pipeline_config_cls=<class 'sglang.multimodal_gen.configs.pipeline_configs.wan.WanT2V480PConfig'>)
[01-30 23:15:23] Using pipeline from model_index.json: WanPipeline
[01-30 23:15:23] Loading pipeline modules...
[01-30 23:15:23] Model already exists locally and is complete
Loading required modules:   0%|          | 0/6 [00:00<?, ?it/s]Loading required modules:   0%|          | 0/6 [00:00<?, ?it/s]Loading required modules:   0%|          | 0/6 [00:00<?, ?it/s][01-30 23:15:23] Model path: ./models/wan2.2
[01-30 23:15:23] Diffusers version: 0.35.0.dev0
[01-30 23:15:23] Loading pipeline modules from config: {'_class_name': 'WanPipeline', '_diffusers_version': '0.35.0.dev0', 'boundary_ratio': 0.875, 'scheduler': ['diffusers', 'UniPCMultistepScheduler'], 'text_encoder': ['transformers', 'UMT5EncoderModel'], 'tokenizer': ['transformers', 'T5TokenizerFast'], 'transformer': ['diffusers', 'WanTransformer3DModel'], 'transformer_2': ['diffusers', 'WanTransformer3DModel'], 'vae': ['diffusers', 'AutoencoderKLWan']}
[01-30 23:15:23] MoE pipeline detected. Adding transformer_2 to self.required_config_modules...
[01-30 23:15:23] MoE pipeline detected. Setting boundary ratio to 0.875
[01-30 23:15:23] Loading required components: ['text_encoder', 'tokenizer', 'vae', 'transformer', 'scheduler', 'transformer_2']
Loading required modules:   0%|          | 0/6 [00:00<?, ?it/s]Loading required modules:   0%|          | 0/6 [00:00<?, ?it/s]Loading required modules:   0%|          | 0/6 [00:00<?, ?it/s]Loading required modules:   0%|          | 0/6 [00:00<?, ?it/s]Loading required modules:   0%|          | 0/6 [00:00<?, ?it/s][01-30 23:15:23] Loading text_encoder from ./models/wan2.2/text_encoder. avail mem: 75.29 GB
[01-30 23:15:37] [RunAI Streamer] Overall time to stream 10.6 GiB of all files to cpu: 14.11s, 768.2 MiB/s
[01-30 23:15:37] [RunAI Streamer] Overall time to stream 10.6 GiB of all files to cpu: 12.87s, 842.2 MiB/s
[01-30 23:15:37] [RunAI Streamer] Overall time to stream 10.6 GiB of all files to cpu: 12.92s, 838.8 MiB/s
[01-30 23:15:37] [RunAI Streamer] Overall time to stream 10.6 GiB of all files to cpu: 12.95s, 836.4 MiB/s
[01-30 23:15:37] [RunAI Streamer] Overall time to stream 10.6 GiB of all files to cpu: 12.97s, 835.7 MiB/s
[01-30 23:15:37] [RunAI Streamer] Overall time to stream 10.6 GiB of all files to cpu: 12.98s, 835.0 MiB/s
[01-30 23:15:37] [RunAI Streamer] Overall time to stream 10.6 GiB of all files to cpu: 13.06s, 829.5 MiB/s
[01-30 23:15:37] [RunAI Streamer] Overall time to stream 10.6 GiB of all files to cpu: 13.19s, 821.5 MiB/s
[01-30 23:16:01] Loaded text_encoder: FSDPUMT5EncoderModel (sgl-diffusion version). model size: 21.16 GB, avail mem: 71.27 GB
Loading required modules:  17%|█▋        | 1/6 [00:37<03:09, 37.94s/it][01-30 23:16:01] Loading tokenizer from ./models/wan2.2/tokenizer. avail mem: 71.27 GB
[01-30 23:16:01] Loaded tokenizer: T5TokenizerFast (sgl-diffusion version). model size: 0.00 GB, avail mem: 71.27 GB
Loading required modules:  33%|███▎      | 2/6 [00:38<01:03, 15.96s/it][01-30 23:16:01] Loading vae from ./models/wan2.2/vae. avail mem: 71.27 GB
[01-30 23:16:02] Loaded vae: AutoencoderKLWan (sgl-diffusion version). model size: 0.27 GB, avail mem: 71.26 GB
Loading required modules:  50%|█████     | 3/6 [00:38<00:26,  8.83s/it][01-30 23:16:02] Loading transformer from ./models/wan2.2/transformer. avail mem: 71.26 GB
[01-30 23:16:02] Loading WanTransformer3DModel from 12 safetensors files, default_dtype: torch.bfloat16
[01-30 23:16:02] Using Sage Attention backend
Loading required modules:  17%|█▋        | 1/6 [00:39<03:17, 39.43s/it]Loading required modules:  33%|███▎      | 2/6 [00:39<01:06, 16.51s/it]Loading required modules:  50%|█████     | 3/6 [00:40<00:27,  9.08s/it]Loading required modules:  17%|█▋        | 1/6 [00:41<03:27, 41.54s/it]Loading required modules:  33%|███▎      | 2/6 [00:42<01:09, 17.38s/it]Loading required modules:  17%|█▋        | 1/6 [00:42<03:30, 42.06s/it]Loading required modules:  50%|█████     | 3/6 [00:42<00:28,  9.53s/it]Loading required modules:  33%|███▎      | 2/6 [00:42<01:10, 17.59s/it]Loading required modules:  50%|█████     | 3/6 [00:42<00:28,  9.64s/it]Loading required modules:  17%|█▋        | 1/6 [00:42<03:33, 42.70s/it]Loading required modules:  17%|█▋        | 1/6 [00:42<03:33, 42.71s/it]Loading required modules:  17%|█▋        | 1/6 [00:42<03:33, 42.71s/it]Loading required modules:  17%|█▋        | 1/6 [00:42<03:33, 42.74s/it]Loading required modules:  33%|███▎      | 2/6 [00:43<01:11, 17.84s/it]Loading required modules:  33%|███▎      | 2/6 [00:43<01:11, 17.84s/it]Loading required modules:  33%|███▎      | 2/6 [00:43<01:11, 17.84s/it]Loading required modules:  33%|███▎      | 2/6 [00:43<01:11, 17.85s/it]Loading required modules:  50%|█████     | 3/6 [00:43<00:29,  9.78s/it]Loading required modules:  50%|█████     | 3/6 [00:43<00:29,  9.79s/it]Loading required modules:  50%|█████     | 3/6 [00:43<00:29,  9.79s/it]Loading required modules:  50%|█████     | 3/6 [00:43<00:29,  9.79s/it][01-30 23:43:18] Rank 0 scheduler is dead. Please check if there are relevant logs.
[rank1]:[W130 23:43:19.190789247 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=111, addr=[localhost]:52762, remote=[localhost]:30050): Connection reset by peer
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:679 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14997cc86278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14997cc87b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1499bf0905b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffda13 (0x1499bf091a13 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe55a (0x1499bf09255a in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x31e (0x1499bf08d27e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14997dc0b868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1499f01cb5e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x1499f39f519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x1499f50b71ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1499f4588953 in /lib64/libc.so.6)

[rank7]:[W130 23:43:19.190668767 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=110, addr=[localhost]:52740, remote=[localhost]:30050): Connection reset by peer
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:679 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14adf269a278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14adf269bb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14ae34aa45b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffda13 (0x14ae34aa5a13 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe55a (0x14ae34aa655a in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x31e (0x14ae34aa127e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14adf361f868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14ae59b725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14ae6940719d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14ae6aac91ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14ae69f9a953 in /lib64/libc.so.6)

[rank2]:[W130 23:43:19.190900225 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=111, addr=[localhost]:52742, remote=[localhost]:30050): Connection reset by peer
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:679 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x15108cae2278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x15108cae3b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1510ceeec5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffda13 (0x1510ceeeda13 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe55a (0x1510ceeee55a in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x31e (0x1510ceee927e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x15108da67868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1510f3e705e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x15110385119d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151104f131ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1511043e4953 in /lib64/libc.so.6)

[rank4]:[W130 23:43:19.190861954 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=110, addr=[localhost]:52732, remote=[localhost]:30050): Connection reset by peer
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:679 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x151d169e8278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x151d169e9b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x151d58df25b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffda13 (0x151d58df3a13 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe55a (0x151d58df455a in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x31e (0x151d58def27e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x151d1796d868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x151d7dd725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x151d8d75519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151d8ee171ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x151d8e2e8953 in /lib64/libc.so.6)

[rank3]:[W130 23:43:19.190829410 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=111, addr=[localhost]:52756, remote=[localhost]:30050): Connection reset by peer
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:679 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14b3abdce278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14b3abdcfb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14b3ee1d85b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffda13 (0x14b3ee1d9a13 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe55a (0x14b3ee1da55a in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x31e (0x14b3ee1d527e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14b3acd53868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14b420a245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14b422b3c19d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14b4241fe1ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14b4236cf953 in /lib64/libc.so.6)

[rank6]:[W130 23:43:19.190962583 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=109, addr=[localhost]:52718, remote=[localhost]:30050): Connection reset by peer
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:679 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14bd59fe3278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14bd59fe4b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14bd9c3ed5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffda13 (0x14bd9c3eea13 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe55a (0x14bd9c3ef55a in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x31e (0x14bd9c3ea27e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14bd5af68868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14bdc95245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14bdd0d5219d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14bdd24141ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14bdd18e5953 in /lib64/libc.so.6)

[rank1]:[W130 23:43:19.384064279 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 1] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Connection reset by peer
[rank7]:[W130 23:43:19.384079183 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 7] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Connection reset by peer
[rank6]:[W130 23:43:19.384077231 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 6] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Connection reset by peer
[rank4]:[W130 23:43:19.384072479 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 4] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Connection reset by peer
[rank2]:[W130 23:43:19.384074107 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 2] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Connection reset by peer
[rank3]:[W130 23:43:19.384066455 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 3] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Connection reset by peer
[rank2]:[W130 23:43:20.439011386 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52742, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x15108cae2278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x15108cae3b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1510ceeec5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1510ceeece42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1510ceeee94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1510ceee926e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x15108da67868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1510f3e705e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x15110385119d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151104f131ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1511043e4953 in /lib64/libc.so.6)

[rank7]:[W130 23:43:20.439014637 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52740, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14adf269a278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14adf269bb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14ae34aa45b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14ae34aa4e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14ae34aa694e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14ae34aa126e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14adf361f868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14ae59b725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14ae6940719d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14ae6aac91ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14ae69f9a953 in /lib64/libc.so.6)

[rank6]:[W130 23:43:20.439010667 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=109, addr=[localhost]:52718, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14bd59fe3278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14bd59fe4b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14bd9c3ed5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14bd9c3ede42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14bd9c3ef94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14bd9c3ea26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14bd5af68868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14bdc95245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14bdd0d5219d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14bdd24141ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14bdd18e5953 in /lib64/libc.so.6)

[rank1]:[W130 23:43:20.438994387 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52762, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14997cc86278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14997cc87b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1499bf0905b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1499bf090e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1499bf09294e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1499bf08d26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14997dc0b868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1499f01cb5e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x1499f39f519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x1499f50b71ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1499f4588953 in /lib64/libc.so.6)

[rank3]:[W130 23:43:20.438997457 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52756, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14b3abdce278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14b3abdcfb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14b3ee1d85b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14b3ee1d8e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14b3ee1da94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14b3ee1d526e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14b3acd53868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14b420a245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14b422b3c19d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14b4241fe1ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14b4236cf953 in /lib64/libc.so.6)

[rank4]:[W130 23:43:20.439014366 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52732, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x151d169e8278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x151d169e9b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x151d58df25b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x151d58df2e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x151d58df494e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x151d58def26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x151d1796d868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x151d7dd725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x151d8d75519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151d8ee171ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x151d8e2e8953 in /lib64/libc.so.6)

[rank7]:[W130 23:43:20.513619245 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 7] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank6]:[W130 23:43:20.513614876 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 6] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank2]:[W130 23:43:20.513632305 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 2] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank3]:[W130 23:43:20.513626278 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 3] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank4]:[W130 23:43:20.513632766 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 4] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank1]:[W130 23:43:20.513638640 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 1] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank3]:[W130 23:43:21.574381573 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52756, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14b3abdce278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14b3abdcfb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14b3ee1d85b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14b3ee1d8e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14b3ee1da94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14b3ee1d526e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14b3acd53868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14b420a245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14b422b3c19d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14b4241fe1ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14b4236cf953 in /lib64/libc.so.6)

[rank4]:[W130 23:43:21.574388797 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52732, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x151d169e8278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x151d169e9b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x151d58df25b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x151d58df2e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x151d58df494e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x151d58def26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x151d1796d868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x151d7dd725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x151d8d75519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151d8ee171ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x151d8e2e8953 in /lib64/libc.so.6)

[rank2]:[W130 23:43:21.574390499 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52742, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x15108cae2278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x15108cae3b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1510ceeec5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1510ceeece42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1510ceeee94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1510ceee926e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x15108da67868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1510f3e705e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x15110385119d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151104f131ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1511043e4953 in /lib64/libc.so.6)

[rank1]:[W130 23:43:21.574394213 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52762, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14997cc86278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14997cc87b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1499bf0905b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1499bf090e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1499bf09294e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1499bf08d26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14997dc0b868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1499f01cb5e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x1499f39f519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x1499f50b71ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1499f4588953 in /lib64/libc.so.6)

[rank7]:[W130 23:43:21.574388797 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52740, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14adf269a278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14adf269bb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14ae34aa45b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14ae34aa4e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14ae34aa694e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14ae34aa126e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14adf361f868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14ae59b725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14ae6940719d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14ae6aac91ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14ae69f9a953 in /lib64/libc.so.6)

[rank6]:[W130 23:43:21.574397719 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=109, addr=[localhost]:52718, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14bd59fe3278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14bd59fe4b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14bd9c3ed5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14bd9c3ede42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14bd9c3ef94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14bd9c3ea26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14bd5af68868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14bdc95245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14bdd0d5219d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14bdd24141ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14bdd18e5953 in /lib64/libc.so.6)

[rank4]:[W130 23:43:21.639951030 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 4] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank3]:[W130 23:43:21.639958140 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 3] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank2]:[W130 23:43:21.639965460 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 2] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank1]:[W130 23:43:21.639971297 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 1] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank6]:[W130 23:43:21.639963182 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 6] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank7]:[W130 23:43:21.639966858 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 7] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank1]:[W130 23:43:22.651082540 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52762, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14997cc86278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14997cc87b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1499bf0905b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1499bf090e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1499bf09294e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1499bf08d26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14997dc0b868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1499f01cb5e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x1499f39f519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x1499f50b71ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1499f4588953 in /lib64/libc.so.6)

[rank7]:[W130 23:43:22.651085551 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52740, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14adf269a278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14adf269bb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14ae34aa45b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14ae34aa4e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14ae34aa694e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14ae34aa126e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14adf361f868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14ae59b725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14ae6940719d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14ae6aac91ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14ae69f9a953 in /lib64/libc.so.6)

[rank3]:[W130 23:43:22.651075592 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52756, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14b3abdce278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14b3abdcfb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14b3ee1d85b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14b3ee1d8e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14b3ee1da94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14b3ee1d526e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14b3acd53868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14b420a245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14b422b3c19d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14b4241fe1ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14b4236cf953 in /lib64/libc.so.6)

[rank4]:[W130 23:43:22.651079391 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52732, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x151d169e8278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x151d169e9b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x151d58df25b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x151d58df2e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x151d58df494e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x151d58def26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x151d1796d868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x151d7dd725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x151d8d75519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151d8ee171ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x151d8e2e8953 in /lib64/libc.so.6)

[rank2]:[W130 23:43:22.651071641 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52742, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x15108cae2278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x15108cae3b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1510ceeec5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1510ceeece42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1510ceeee94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1510ceee926e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x15108da67868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1510f3e705e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x15110385119d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151104f131ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1511043e4953 in /lib64/libc.so.6)

[rank6]:[W130 23:43:22.651078049 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=109, addr=[localhost]:52718, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14bd59fe3278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14bd59fe4b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14bd9c3ed5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14bd9c3ede42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14bd9c3ef94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14bd9c3ea26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14bd5af68868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14bdc95245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14bdd0d5219d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14bdd24141ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14bdd18e5953 in /lib64/libc.so.6)

[rank3]:[W130 23:43:22.719766992 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 3] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank7]:[W130 23:43:22.719782353 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 7] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank4]:[W130 23:43:22.719770747 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 4] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank1]:[W130 23:43:22.719778893 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 1] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank6]:[W130 23:43:22.719780285 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 6] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank2]:[W130 23:43:22.719775223 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 2] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank1]:[W130 23:43:23.744066001 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52762, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14997cc86278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14997cc87b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1499bf0905b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1499bf090e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1499bf09294e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1499bf08d26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14997dc0b868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1499f01cb5e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x1499f39f519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x1499f50b71ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1499f4588953 in /lib64/libc.so.6)

[rank6]:[W130 23:43:23.744070137 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=109, addr=[localhost]:52718, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14bd59fe3278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14bd59fe4b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14bd9c3ed5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14bd9c3ede42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14bd9c3ef94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14bd9c3ea26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14bd5af68868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14bdc95245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14bdd0d5219d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14bdd24141ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14bdd18e5953 in /lib64/libc.so.6)

[rank4]:[W130 23:43:23.744073168 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52732, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x151d169e8278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x151d169e9b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x151d58df25b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x151d58df2e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x151d58df494e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x151d58def26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x151d1796d868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x151d7dd725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x151d8d75519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151d8ee171ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x151d8e2e8953 in /lib64/libc.so.6)

[rank7]:[W130 23:43:23.744062492 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52740, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14adf269a278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14adf269bb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14ae34aa45b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14ae34aa4e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14ae34aa694e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14ae34aa126e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14adf361f868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14ae59b725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14ae6940719d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14ae6aac91ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14ae69f9a953 in /lib64/libc.so.6)

[rank2]:[W130 23:43:23.744073272 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52742, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x15108cae2278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x15108cae3b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1510ceeec5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1510ceeece42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1510ceeee94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1510ceee926e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x15108da67868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1510f3e705e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x15110385119d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151104f131ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1511043e4953 in /lib64/libc.so.6)

[rank3]:[W130 23:43:23.744074117 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52756, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14b3abdce278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14b3abdcfb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14b3ee1d85b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14b3ee1d8e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14b3ee1da94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14b3ee1d526e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14b3acd53868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14b420a245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14b422b3c19d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14b4241fe1ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14b4236cf953 in /lib64/libc.so.6)

[rank3]:[W130 23:43:23.795417031 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 3] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank1]:[W130 23:43:23.795413801 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 1] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank2]:[W130 23:43:23.795425998 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 2] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank4]:[W130 23:43:23.795421598 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 4] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank6]:[W130 23:43:23.795423123 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 6] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank7]:[W130 23:43:23.795422996 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 7] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank6]:[W130 23:43:24.810116922 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=109, addr=[localhost]:52718, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14bd59fe3278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14bd59fe4b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14bd9c3ed5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14bd9c3ede42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14bd9c3ef94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14bd9c3ea26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14bd5af68868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14bdc95245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14bdd0d5219d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14bdd24141ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14bdd18e5953 in /lib64/libc.so.6)

[rank2]:[W130 23:43:24.810111479 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52742, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x15108cae2278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x15108cae3b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1510ceeec5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1510ceeece42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1510ceeee94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1510ceee926e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x15108da67868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1510f3e705e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x15110385119d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151104f131ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1511043e4953 in /lib64/libc.so.6)

[rank1]:[W130 23:43:24.810115510 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52762, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14997cc86278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14997cc87b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1499bf0905b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1499bf090e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1499bf09294e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1499bf08d26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14997dc0b868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1499f01cb5e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x1499f39f519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x1499f50b71ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1499f4588953 in /lib64/libc.so.6)

[rank4]:[W130 23:43:24.810103233 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52732, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x151d169e8278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x151d169e9b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x151d58df25b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x151d58df2e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x151d58df494e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x151d58def26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x151d1796d868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x151d7dd725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x151d8d75519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151d8ee171ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x151d8e2e8953 in /lib64/libc.so.6)

[rank3]:[W130 23:43:24.810107339 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52756, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14b3abdce278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14b3abdcfb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14b3ee1d85b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14b3ee1d8e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14b3ee1da94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14b3ee1d526e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14b3acd53868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14b420a245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14b422b3c19d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14b4241fe1ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14b4236cf953 in /lib64/libc.so.6)

[rank7]:[W130 23:43:24.810109776 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52740, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14adf269a278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14adf269bb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14ae34aa45b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14ae34aa4e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14ae34aa694e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14ae34aa126e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14adf361f868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14ae59b725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14ae6940719d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14ae6aac91ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14ae69f9a953 in /lib64/libc.so.6)

[rank3]:[W130 23:43:24.888346465 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 3] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank6]:[W130 23:43:24.888357859 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 6] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank7]:[W130 23:43:24.888353672 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 7] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank1]:[W130 23:43:24.888343663 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 1] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank4]:[W130 23:43:24.888356357 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 4] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank2]:[W130 23:43:24.888352332 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 2] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[01-30 23:43:25] Exit code: -9
Traceback (most recent call last):
  File "/scratch/user/u.dl344013/sglang-offload-research/venv/bin/sglang", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/sglang/cli/main.py", line 42, in main
    args.func(args, extra_argv)
  File "/scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/sglang/cli/generate.py", line 29, in generate
    generate_cmd(parsed_args)
  File "/scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/sglang/multimodal_gen/runtime/entrypoints/cli/generate.py", line 116, in generate_cmd
    generator = DiffGenerator.from_pretrained(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/sglang/multimodal_gen/runtime/entrypoints/diffusion_generator.py", line 102, in from_pretrained
    return cls.from_server_args(server_args, local_mode=local_mode)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/sglang/multimodal_gen/runtime/entrypoints/diffusion_generator.py", line 122, in from_server_args
    instance.local_scheduler_process = instance._start_local_server_if_needed()
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/sglang/multimodal_gen/runtime/entrypoints/diffusion_generator.py", line 139, in _start_local_server_if_needed
    processes = launch_server(self.server_args, launch_http_server=False)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/sglang/multimodal_gen/runtime/launch_server.py", line 153, in launch_server
    data = reader.recv()
           ^^^^^^^^^^^^^
  File "/scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/multiprocessing/connection.py", line 399, in _recv
    raise EOFError
EOFError
[rank4]:[W130 23:43:25.988551538 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52732, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x151d169e8278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x151d169e9b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x151d58df25b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x151d58df2e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x151d58df494e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x151d58def26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x151d1796d868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x151d7dd725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x151d8d75519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151d8ee171ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x151d8e2e8953 in /lib64/libc.so.6)

[rank6]:[W130 23:43:25.988556195 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=109, addr=[localhost]:52718, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14bd59fe3278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14bd59fe4b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14bd9c3ed5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14bd9c3ede42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14bd9c3ef94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14bd9c3ea26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14bd5af68868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14bdc95245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14bdd0d5219d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14bdd24141ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14bdd18e5953 in /lib64/libc.so.6)

[rank1]:[W130 23:43:25.988561169 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52762, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14997cc86278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14997cc87b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1499bf0905b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1499bf090e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1499bf09294e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1499bf08d26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14997dc0b868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1499f01cb5e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x1499f39f519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x1499f50b71ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1499f4588953 in /lib64/libc.so.6)

[rank2]:[W130 23:43:25.988548011 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52742, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x15108cae2278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x15108cae3b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1510ceeec5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1510ceeece42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1510ceeee94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1510ceee926e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x15108da67868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1510f3e705e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x15110385119d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151104f131ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1511043e4953 in /lib64/libc.so.6)

[rank3]:[W130 23:43:25.988543275 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52756, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14b3abdce278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14b3abdcfb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14b3ee1d85b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14b3ee1d8e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14b3ee1da94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14b3ee1d526e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14b3acd53868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14b420a245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14b422b3c19d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14b4241fe1ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14b4236cf953 in /lib64/libc.so.6)

[rank7]:[W130 23:43:25.988539136 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52740, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14adf269a278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14adf269bb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14ae34aa45b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14ae34aa4e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14ae34aa694e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14ae34aa126e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14adf361f868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14ae59b725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14ae6940719d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14ae6aac91ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14ae69f9a953 in /lib64/libc.so.6)

[rank1]:[W130 23:43:26.285397511 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 1] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank7]:[W130 23:43:26.283906407 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 7] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank3]:[W130 23:43:26.283896972 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 3] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank2]:[W130 23:43:26.283899366 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 2] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank6]:[W130 23:43:26.285400764 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 6] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank4]:[W130 23:43:26.283892026 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 4] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank4]:[W130 23:43:27.332348661 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52732, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x151d169e8278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x151d169e9b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x151d58df25b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x151d58df2e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x151d58df494e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x151d58def26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x151d1796d868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x151d7dd725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x151d8d75519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151d8ee171ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x151d8e2e8953 in /lib64/libc.so.6)

[rank3]:[W130 23:43:27.332358095 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52756, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14b3abdce278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14b3abdcfb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14b3ee1d85b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14b3ee1d8e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14b3ee1da94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14b3ee1d526e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14b3acd53868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14b420a245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14b422b3c19d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14b4241fe1ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14b4236cf953 in /lib64/libc.so.6)

[rank1]:[W130 23:43:27.332353544 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52762, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14997cc86278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14997cc87b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1499bf0905b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1499bf090e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1499bf09294e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1499bf08d26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14997dc0b868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1499f01cb5e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x1499f39f519d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x1499f50b71ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1499f4588953 in /lib64/libc.so.6)

[rank2]:[W130 23:43:27.332350977 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=111, addr=[localhost]:52742, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x15108cae2278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x15108cae3b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x1510ceeec5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x1510ceeece42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x1510ceeee94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x1510ceee926e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x15108da67868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x1510f3e705e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x15110385119d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x151104f131ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x1511043e4953 in /lib64/libc.so.6)

[rank7]:[W130 23:43:27.332354699 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=110, addr=[localhost]:52740, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14adf269a278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14adf269bb80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14ae34aa45b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14ae34aa4e42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14ae34aa694e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14ae34aa126e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14adf361f868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14ae59b725e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14ae6940719d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14ae6aac91ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14ae69f9a953 in /lib64/libc.so.6)

[rank6]:[W130 23:43:27.332356449 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=109, addr=[localhost]:52718, remote=[localhost]:30050): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: <unknown function> + 0x9c278 (0x14bd59fe3278 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x14bd59fe4b80 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x5ffc5b1 (0x14bd9c3ed5b1 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5ffce42 (0x14bd9c3ede42 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5ffe94e (0x14bd9c3ef94e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x14bd9c3ea26e in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x3c8 (0x14bd5af68868 in /scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0xef5e4 (0x14bdc95245e4 in /scratch/user/u.dl344013/sglang-offload-research/venv/bin/../lib/libstdc++.so.6)
frame #8: <unknown function> + 0x50119d (0x14bdd0d5219d in /sw/eb/sw/CUDA/12.8.0/nsight-systems-2024.6.2/target-linux-x64/libToolsInjection64.so)
frame #9: <unknown function> + 0x81ca (0x14bdd24141ca in /lib64/libpthread.so.0)
frame #10: clone + 0x43 (0x14bdd18e5953 in /lib64/libc.so.6)

[rank6]:[W130 23:43:27.512430578 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 6] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank1]:[W130 23:43:27.512419126 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 1] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank2]:[W130 23:43:27.512435983 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 2] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank7]:[W130 23:43:27.512419249 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 7] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank4]:[W130 23:43:27.512422556 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 4] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank3]:[W130 23:43:27.512429031 ProcessGroupNCCL.cpp:1771] [PG ID 0 PG GUID 0(default_pg) Rank 3] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
/scratch/user/u.dl344013/sglang-offload-research/venv/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 8 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
[2026-01-30T23:45:07.009] error: *** JOB 1422883 ON ac045 CANCELLED AT 2026-01-30T23:45:07 DUE TO TIME LIMIT ***
[2026-01-30T23:45:07.116] error: Detected 2 oom_kill events in StepId=1422883.batch. Some of the step tasks have been OOM Killed.
